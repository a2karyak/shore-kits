#
# @file:  shore.conf
#
# @brief: Shore configuration file
#
# @note:  There is a number of predefined configurations, 
#         make sure to have only 1 "config" parameter set
#



##### Device

# Clobber device (1=yes,0=no)

#db-clobberdev = 1
db-clobberdev = 0



##### Platform-specific Parameter

# CPU Counts
# hard-limit (machine dependent)
sys-maxcpucount = 64
# soft-limit
sys-activecpucount = 64


##### Shore parameters

# Enable/Disable logging (yes/no)
#logging = no
shore-logging = yes

# misc
shore-diskrw = /export/home/ipandis/DEV/shore-lomond/installed/bin/diskrw
shore-errlog = info # one of {none emerg fatal alert internal error warning info debug}

# shore fake io delay (in usec)

# whether the io delay will be enabled or not
shore-fakeiodelay-enable = 1

# the actual delay
#shore-fakeiodelay = 5
shore-fakeiodelay = 0


# number of page cleaners
shore-pagecleaners = 16
#shore-pagecleaners = 4
#shore-pagecleaners = 2



##### Worker parameters

# Number of worker threads
db-workers = 64
#db-workers = 10
#db-workers = 1


# srmw-queue spin
db-queueloops = 1
#db-worker-queueloops = 2000
#db-worker-queueloops = 10000


# Use sli?
db-worker-sli = 0
#db-worker-sli = 1




# Number of loader threads
db-loaders = 1


# Number of (single-threaded) preloads to do before firing up the threads
db-record-preloads = 10000


# Record access trace output dir
dir-trace = RAT


##### Client parameters

# think time 
# note: it should be combined with batchsz=1
db-cl-thinktime = 0

# client batch sz
# !! look also (TABLE)-{inp,com}-q-sz
#db-cl-batchsz = 1
db-cl-batchsz = 30


# worker queue batch sz
# look also client batch sz
db-worker-inp-queue-sz = 15
db-worker-com-queue-sz = 0



##### Workload parameters

# TEST
test-num-queried = 32       # no of whs queried
test-spread      = 1        # 0=No,1=Yes
test-num-threads = 32
test-num-trxs    = 10       # no of trxs per thread
test-trx-id      = 111      # e.g. 2=Base-Pay,102=Dora-Pay
test-iterations  = 2 
test-sli         = 0        # 0=No,1=Yes
test-cl-binding  = 0        # client binding policy - 0=NoBinding,1=Adjacent,2=SpreadToCores

# MEASURE
measure-num-queried = 32    # no of whs queried
measure-spread      = 1     # 0=No,1=Yes
measure-num-threads = 32
measure-duration    = 30    # duration of each iteration (in secs.)
measure-trx-id      = 102   # 2=Base-Pay,102=Dora-Pay
measure-iterations  = 2
measure-sli         = 0
measure-cl-binding  = 0     # client binding policy - 0=NoBinding,1=Adjacent,2=SpreadToCores








#############################
#                           #
# Predefined configurations #
#                           #
#############################

#db-config = 1wh
#db-config = 10wh
db-config = 10wh-nl
#db-config = 100wh-tmpfs
#db-config = 100wh
#db-config = 100wh-nl
#db-config = 1000wh

#db-config = 10sf-tm1
#db-config = 10sf-tm1-nl
#db-config = 100sf-tm1
#db-config = 100sf-tm1-nl

#db-config = tpcb100-dlog10





######################
####              ####
#### 10SF TM-1 DB ####
####              ####
######################

### Device file
10sf-tm1-device = databases/tm1-db-10sf

### Device quota (in KB)
### 200MB
10sf-tm1-devicequota = 204800

### Buffer pool size (in KB)
### 1GB (db in memory)
10sf-tm1-bufpoolsize = 1024000

### Location of log directory
10sf-tm1-logdir = log-tm1-10

### Size of log (in KB)
### 1GB 
10sf-tm1-logsize = 1024000

### Size of log buffer (in KB)
### 80MB
10sf-tm1-logbufsize = 81920

### tm1-sf
10sf-tm1-sf = 10

### system
10sf-tm1-system = baseline

### benchmark
10sf-tm1-benchmark = tm1



###################################
####                           ####
#### 10SF TM-1 DB + NOLOCK-IDX ####
####                           ####
###################################

### Device file
10sf-tm1-nl-device = databases/tm1-db-10sf-nl

### Device quota (in KB)
### 200MB
10sf-tm1-nl-devicequota = 204800

### Buffer pool size (in KB)
### 1GB (db in memory)
10sf-tm1-nl-bufpoolsize = 1024000

### Location of log directory
10sf-tm1-nl-logdir = log-tm1-10-nl

### Size of log (in KB)
### 1GB 
10sf-tm1-nl-logsize = 1024000

### Size of log buffer (in KB)
### 80MB
10sf-tm1-nl-logbufsize = 81920

### tm1-sf
#10sf-tm1-nl-sf = 2
10sf-tm1-nl-sf = 10

### system
10sf-tm1-nl-system = dora

### benchmark
10sf-tm1-nl-benchmark = tm1



#######################
####               ####
#### 100SF TM-1 DB ####
####               ####
#######################

### Device file
100sf-tm1-device = databases/tm1-db-100sf

### Device quota (in KB)
### 2GB
100sf-tm1-devicequota = 2097152

### Buffer pool size (in KB)
### 2GB (db in memory)
100sf-tm1-bufpoolsize = 2097152

### Location of log directory
100sf-tm1-logdir = log-tm1-100

### Size of log (in KB)
### 1GB 
100sf-tm1-logsize = 1024000

### Size of log buffer (in KB)
### 80MB
100sf-tm1-logbufsize = 81920

### tm1-sf
100sf-tm1-sf = 100

### system
100sf-tm1-system = baseline

### benchmark
100sf-tm1-benchmark = tm1



####################################
####                            ####
#### 100SF TM-1 DB + NOLOCK-IDX ####
####                            ####
####################################

### Device file
100sf-tm1-nl-device = databases/tm1-db-100sf-nl

### Device quota (in KB)
### 2GB
100sf-tm1-nl-devicequota = 2097152

### Buffer pool size (in KB)
### 2GB (db in memory)
100sf-tm1-nl-bufpoolsize = 2097152

### Location of log directory
100sf-tm1-nl-logdir = log-tm1-100-nl

### Size of log (in KB)
### 1GB 
100sf-tm1-nl-logsize = 1024000

### Size of log buffer (in KB)
### 80MB
100sf-tm1-nl-logbufsize = 81920

### tm1-sf
100sf-tm1-nl-sf = 100

### system
100sf-tm1-nl-system = dora

### benchmark
100sf-tm1-nl-benchmark = tm1



#########################
####                 ####
####    100 Branch   ####
#### TPC-B DB (~1GB) ####
####                 ####
#########################


### Device file
tpcb100-dlog10-device = databases/tpcb100

### Device quota (in KB)
### 12GB
tpcb100-dlog10-devicequota = 12097152

### Buffer pool size (in KB)
### 4GB (db in memory)
tpcb100-dlog10-bufpoolsize = 4096000

### Location of log directory
tpcb100-dlog10-logdir = tpcblog100

### Size of log (in KB)
### 2GB 
tpcb100-dlog10-logsize = 2048000

### Size of log buffer (in KB)
### 80MB
tpcb100-dlog10-logbufsize = 8192

### Number of log segments
tpcb100-dlog10-logcount = 10

### tpcc-sf
tpcb100-dlog10-sf = 100

### system
tpcb100-dlog10-system = baseline

### benchmark
tpcb100-dlog10-benchmark = tpcb




#########################
####                 ####
#### 1WH DB (~100MB) ####
####                 ####
#########################


### Device file
1wh-device = databases/shore1wh

### Device quota (in KB)
### 200MB
1wh-devicequota = 204800

### Buffer pool size (in KB)
### 1GB (db in memory)
1wh-bufpoolsize = 1024000

### Location of log directory
1wh-logdir = log1

### Size of log (in KB)
### 1GB 
1wh-logsize = 1024000

### Size of log buffer (in KB)
### 80MB
1wh-logbufsize = 81920

### tpcc-specific
1wh-loadatadir = flatfiles/sf1

### tpcc-sf
1wh-sf = 1

### system
1wh-system = baseline

### benchmark
1wh-benchmark = tpcc


########################
####                ####
#### 10WH DB (~1GB) ####
####                ####
########################


### Device file
10wh-device = databases/shore10wh

### Device quota (in KB)
### 12GB
10wh-devicequota = 12097152

### Buffer pool size (in KB)
### 4GB (db in memory)
10wh-bufpoolsize = 4096000

### Location of log directory
10wh-logdir = log10

### Size of log (in KB)
### 2GB 
10wh-logsize = 2048000

### Size of log buffer (in KB)
### 80MB
10wh-logbufsize = 81920

### tpcc-specific
10wh-loadatadir = flatfiles/sf10

### tpcc-sf
10wh-sf = 10

### system
10wh-system = baseline

### benchmark
10wh-benchmark = tpcc




#####################################
####                             ####
#### 10WH DB + NOLOCK-IDX (~1GB) ####
####                             ####
#####################################


### Device file
10wh-nl-device = databases/shore10wh-nl

### Device quota (in KB)
### 12GB
10wh-nl-devicequota = 12097152

### Buffer pool size (in KB)
### 4GB (db in memory)
10wh-nl-bufpoolsize = 4096000

### Location of log directory
10wh-nl-logdir = log10-nl

### Size of log (in KB)
### 2GB 
10wh-nl-logsize = 2048000

### Size of log buffer (in KB)
### 80MB
10wh-nl-logbufsize = 81920

### tpcc-specific
10wh-nl-loadatadir = flatfiles/sf10

### tpcc-sf
#10wh-nl-sf = 1
#10wh-nl-sf = 8
10wh-nl-sf = 10

### system
10wh-nl-system = dora

### benchmark
10wh-nl-benchmark = tpcc



################################
####                        ####
#### 100WH DB TMPFS (~15GB) ####
####                        ####
################################


### Device file
# In TMPFS
100wh-tmpfs-device = tmpfsdatabases/shore100wh

### Device quota (in KB)
### 20GB
100wh-tmpfs-devicequota = 20971520


### Buffer pool size (in KB)
### 12GB (db in memory)
#100wh-tmpfs-bufpoolsize = 12582912
### 5GB (5/13~38% in bpool)
#100wh-tmpfs-bufpoolsize = 5242880
### 4GB (4/13~30% in bpool)
100wh-tmpfs-bufpoolsize = 4194304

### Location of log directory
100wh-tmpfs-logdir = tmpfslog100

### Size of log (in KB)
### 2GB
100wh-tmpfs-logsize = 2048000

### Size of log buffer (in KB)
### 80MB
100wh-tmpfs-logbufsize = 81920

### tpcc-specific
100wh-tmpfs-loadatadir = flatfiles/sf100

### tpcc-sf
100wh-tmpfs-sf = 100

### system
100wh-tmpfs-system = baseline

### benchmark
100wh-tmpfs-benchmark = tpcc



##########################
####                  ####
#### 100WH DB (~15GB) ####
####                  ####
##########################


### Device file
100wh-device = databases/shore100wh

### Device quota (in KB)
### 20GB
100wh-devicequota = 20971520

### Buffer pool size (in KB)
### 5GB (5/13~38% in mem)
100wh-bufpoolsize = 5242880

### Location of log directory
100wh-logdir = log100

### Size of log (in KB)
### 2GB
100wh-logsize = 2048000

### Size of log buffer (in KB)
### 80MB
100wh-logbufsize = 81920

### tpcc-specific
100wh-loadatadir = flatfiles/sf100

### tpcc-sf
100wh-sf = 100

### system
100wh-system = baseline

### benchmark
100wh-benchmark = tpcc



 
#######################################
####                               ####
#### 100WH DB + NOLOCK-IDX (~15GB) ####
####                               ####
#######################################


### Device file
100wh-nl-device = databases/shore100wh-nl

### Device quota (in KB)
### 20GB
100wh-nl-devicequota = 20971520

### Buffer pool size (in KB)
### 12GB (db in memory)
100wh-nl-bufpoolsize = 12582912

### Location of log directory
100wh-nl-logdir = log100-nl

### Size of log (in KB)
### 2GB 
100wh-nl-logsize = 2048000

### Size of log buffer (in KB)
### 80MB
100wh-nl-logbufsize = 81920

### tpcc-specific
100wh-nl-loadatadir = flatfiles/sf100

### tpcc-sf
#100wh-nl-sf = 1
#100wh-nl-sf = 2
#100wh-nl-sf = 32
100wh-nl-sf = 64
#100wh-nl-sf = 100

### system
100wh-nl-system = dora

### benchmark
100wh-nl-benchmark = tpcc




############################
####                    ####
#### 1000WH DB (~100GB) ####
####                    ####
############################


### Device file
1000wh-device = tbl_tpcc/shore1000wh

### Device quota (in KB)
### 200GB
1000wh-devicequota = 204800000

### Buffer pool size (in KB)
### 10GB (db in disk)
1000wh-bufpoolsize = 10240000

### Location of log directory
1000wh-logdir = dsklog

### Size of log (in KB)
### 4GB
1000wh-logsize = 4096000

### Size of log buffer (in KB)
### 80MB
1000wh-logbufsize = 81920


### tpcc-specific
1000wh-loadatadir = flatfiles/sf1000

### tpcc-sf
1000wh-sf = 1000

### system
1000wh-system = baseline

### benchmark
1000wh-benchmark = tpcc





#################################
#                               #
# EOF Predefined configurations #
#                               #
#################################




##### DORA parameters


# dora worker thread binding policy
# 0=NoBinding,1=Other
dora-cpu-binding = 0

# starting cpu - the initial cpu of the dora tables
dora-cpu-starting = 2

# table-step - the number of cpus between two tables
dora-cpu-table-step = 16

# partition-step - the number of cpus between two partitions of the same table
dora-cpu-partition-step = 2



##### DORA TPC-C setup

# IP: For taking the record access traces
#dora-tpcc-wh-per-part-wh    = 1
#dora-tpcc-wh-per-part-dist  = 1
#dora-tpcc-wh-per-part-cust  = 1
#dora-tpcc-wh-per-part-hist  = 1

dora-tpcc-wh-per-part-wh    = 2 # 2
dora-tpcc-wh-per-part-dist  = 2 # 2
dora-tpcc-wh-per-part-cust  = 1
dora-tpcc-wh-per-part-hist  = 1

# IP: The optimal for PAY
#dora-tpcc-wh-per-part-wh    = 3
#dora-tpcc-wh-per-part-dist  = 3
#dora-tpcc-wh-per-part-cust  = 1
#dora-tpcc-wh-per-part-hist  = 1

dora-tpcc-wh-per-part-nord  = 100 # IP: only one partition
dora-tpcc-wh-per-part-ord   = 100
dora-tpcc-wh-per-part-item  = 100
dora-tpcc-wh-per-part-oline = 100
dora-tpcc-wh-per-part-stock = 100


WAREHOUSE-inp-q-sz = 30
WAREHOUSE-com-q-sz = 0

DISTRICT-inp-q-sz = 30
DISTRICT-com-q-sz = 0

CUSTOMER-inp-q-sz = 30
CUSTOMER-com-q-sz = 0

HISTORY-inp-q-sz = 0
HISTORY-com-q-sz = 0




##### DORA TM1 setup

dora-tm1-sf-per-part-sub = 1
dora-tm1-sf-per-part-ai  = 1
dora-tm1-sf-per-part-sf  = 1
dora-tm1-sf-per-part-cf  = 1



SUBSCRIBER-inp-q-sz = 30
SUBSCRIBER-com-q-sz = 0

ACCESS_INFO-inp-q-sz = 30
ACCESS_INFO-com-q-sz = 0

SPECIAL_FACILITY-inp-q-sz = 30
SPECIAL_FACILITY-com-q-sz = 0

CALL_FORWARDING-inp-q-sz = 30
CALL_FORWARDING-com-q-sz = 0
